<DOCTYPE html>
<html>
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Atharva Bhat">
    <html lang="en-us">

    <!-- Form Website will be created using Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Orbitron" rel="stylesheet">

    <!-- Custom CSS -->
    <style>
      body {
        background-color:black;
        color:white;
      }
      .jumbotron{
        padding: 100px 25px 0px;
        background-color:inherit;

      }

      .center{
        width:50%;
        margin:auto;
      }

      img {
        margin:auto;
        width:500px;
        height:500px;
      }

      .bg-footer{
          padding:10px;
          margin-top:50px;
          color:black;
          background-color: #f8f8f8
      }

      .icons{
        font-size:25px;
        padding:10px;
        color:black;
      }

      h1{font-family: 'Orbitron', sans-serif;}

    </style>


  </head>

  <body>

    <!-- Navigation bar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#home">PHASES OF THE MOON</a>
          </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="#">VIEW MOON</a></li>
          <li><a href="#">ABOUT PHASES</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="jumbotron text-center">
    <h1> Welcome to phases!</h1>
  </div>

  <div class= "container text-center">
    <img id="moon" class= "img-responsive" src="" />
    <p id="stats"></p>
  </div>
 <!-- Form which is arranged using BS grid system -->
  <div class="container">
      <form class="center">
        <div class="row">
          <div class="col-sm-4">
            <div class="form-group">
              <label for="month">Month</label>
              <select id="month" class="form-control"></select>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label for="day">Day</label>
              <select id="day" class="form-control"></select>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label for="year">Year</label>
              <input id="year" data-toggle="tooltip" data-placement="right" title="Year must be between 1700 and 2100" class="form-control" type="number"
              oninput="this.value=this.value.slice(0,4)" min="1700" max="2100" placeholder="YYYY">
            </div>
          </div>
      </div>

      <div class= "row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="hour">Hour</label>
            <select id="hour" class="form-control"></select>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="minute">Minute</label>
            <select id="minute" class="form-control"></select>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="location">Location</label>
            <input id="location" data-toggle="tooltip" data-placement="right" title="Location must be in United States"type="text" class="form-control" placeholder="Mountain View, CA">
          </div>
        </div>
      </div>

      <button type="button" onclick="calcPhase()" class="btn btn-primary">Find phase!</button>
      </form>
  </div>


  <footer class="container-fluid bg-footer text-center">
    <div class="container text-center">
        <p style="font-size:15px; font-family:'Orbitron', sans-serif;">Created by Atharva Bhat</p>
        <a href="https://www.facebook.com/stopStalkingMePleaseee"><span class="fa fa-facebook icons"></span></a>
        <a href="https://www.linkedin.com/in/atharva-bhat-414319122?trk=hp-identity-photo"><span class="fa fa-linkedin icons"></span></a>
        <a href="https://github.com/AtharvaLarva"><span class="fa fa-github icons"></span></a>

    </div>
  </footer>



    <!-- Scripts added to the bottom to improve page loading -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Enables Bootstrap tooltips -->
    <script>
      $(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();});
    </script>

    <!-- Retrieves the moon image and calculates respective phase statistics -->
    <script>
      function calcPhase(){
        var moon= document.getElementById("moon");
        var stats= document.getElementById("stats");
        var date= (months.indexOf(monthSelect.value)+1) + "/" + daySelect.value + "/" + yearSelect.value;
        var time= hourSelect.value + ":" + minuteSelect.value;
        var imgUrl = "http://api.usno.navy.mil/imagery/moon.png?date=" + date + "&time=" + time;
        var statURL= "http://api.usno.navy.mil/rstt/oneday?date=" + date + "&loc=" + locationSelect.value;

        console.log(statURL);
        console.log(imgUrl);
        moon.src=imgUrl;
        $.getJSON(statURL, function(data) {

            var curphase= data["curphase"];
            var fracillum= data["fracillum"];
            var moonrise= data["moondata"][0]["time"];
            var moonset= data["moondata"][2]["time"];
            var closestPhase= data["closestphase"]["phase"];
            var closestPhaseDate= data["closestphase"]["date"];
            var statText;

            statText= "On " + date +  " at " +  locationSelect.value + " ,the moon is in the " + "<b>"+ curphase  + "</b>" + " phase";
            statText+= " and is " + "<b>" + fracillum + "</b>" + " full.";
            statText+="<br /> The closest phase is the " + closestPhase + " phase, which occurs on " + closestPhaseDate;
            statText+="<br /> Moonrise: " + moonrise + ". Moonset: " + moonset;
            stats.class="";
            stats.innerHTML= statText;


        });
      }
    </script>

    <!-- Initializes options for dropdowns an calculates phase for current day -->
    <script>
      var daySelect= document.getElementById("day");
      var hourSelect= document.getElementById("hour");
      var minuteSelect= document.getElementById("minute");
      var monthSelect= document.getElementById("month");
      var yearSelect= document.getElementById("year");
      var locationSelect= document.getElementById("location");


      var months= ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      var today= new Date();
      var hourText = minuteText = dayText = monthText= "";

      for (var i=0; i<months.length; i++){monthText+="<option>" + months[i] + "</option>";}
      for (var i=1; i<32; i++){dayText+="<option>" + i + "</option>";}
      for (var i=0; i<24; i++){hourText+="<option>" + i + "</option>";}
      for (var i=0; i<60; i++){minuteText+="<option>" + i + "</option>";}


      daySelect.innerHTML=dayText;
      hourSelect.innerHTML=hourText;
      minuteSelect.innerHTML=minuteText;
      monthSelect.innerHTML=monthText;

      monthSelect.value= months[today.getMonth()];
      daySelect.value= today.getDate();
      hourSelect.value= today.getHours();
      minuteSelect.value= today.getMinutes();
      yearSelect.value= today.getFullYear();
      locationSelect.value= "Washington, DC";

      calcPhase();
    </script>








  </body>
</html>
