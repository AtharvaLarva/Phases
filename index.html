<DOCTYPE html>
<html>
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Atharva Bhat">
    <html lang="en-us">

    <!-- Form Website will be created using Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- Custom styles -->
    <style>
      body {
        background-color:black;
        color:white;
      }
      .jumbotron{
        background-color:inherit;
        margin-bottom:0px;
      }

      .center{
        width:50%;
        margin:auto;
      }

      img {
        margin:auto;
        width:500px;
        height:500px;
      }

    </style>


  </head>

  <body>

    <!-- Navigation bar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#home">PHASES OF THE MOON</a>
          </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="#">VIEW MOON</a></li>
          <li><a href="#">ABOUT PHASES</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="jumbotron text-center">
    <h1> Welcome to phases!</h1>
  </div>

  <div class= "container text-center">
    <img id="moon" src="" />
  </div>
 <!-- Form which is arranged using BS grid system -->
  <div class="container">
      <form class="center">
        <div class="row">
          <div class="col-sm-4">
            <div class="form-group">
              <label for="month">Month</label>
              <select id="month" class="form-control"></select>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label for="day">Day</label>
              <select id="day" class="form-control"></select>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label for="year">Year</label>
              <input id="year" class="form-control" type="number" oninput="this.value=this.value.slice(0,4)" min="1700" max="2100" placeholder="YYYY">
            </div>
          </div>
      </div>

      <div class= "row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="hour">Hour</label>
            <select id="hour" class="form-control"></select>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="minute">Minute</label>
            <select id="minute" class="form-control"></select>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="location">Location</label>
            <input id="location" type="text" class="form-control" placeholder="Mountain View, CA">
          </div>
        </div>
      </div>

      <button type="button" onclick="calcPhase()" class="btn btn-primary">Find phase!</button>


      </form>
  </div>







    <!-- Initializes options for dropdowns -->

    <script>
      function calcPhase(){
        var moon= document.getElementById("moon");
        var date= (months.indexOf(monthSelect.value)+1) + "/" + daySelect.value + "/" + yearSelect.value;
        var time= hourSelect.value + ":" + minuteSelect.value;
        var url = "http://api.usno.navy.mil/imagery/moon.png?date=" + date + "&time=" + time;
        console.log(url);
        moon.src=url;
      }
    </script>


    <script>
      var daySelect= document.getElementById("day");
      var hourSelect= document.getElementById("hour");
      var minuteSelect= document.getElementById("minute");
      var monthSelect= document.getElementById("month");
      var yearSelect= document.getElementById("year");


      var months= ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      var today= new Date();
      var hourText = minuteText = dayText = monthText= "";

      for (var i=0; i<months.length; i++){monthText+="<option>" + months[i] + "</option>";}
      for (var i=1; i<32; i++){dayText+="<option>" + i + "</option>";}
      for (var i=0; i<24; i++){hourText+="<option>" + i + "</option>";}
      for (var i=0; i<60; i++){minuteText+="<option>" + i + "</option>";}


      daySelect.innerHTML=dayText;
      hourSelect.innerHTML=hourText;
      minuteSelect.innerHTML=minuteText;
      monthSelect.innerHTML=monthText;

      monthSelect.value= months[today.getMonth()];
      daySelect.value= today.getDate();
      hourSelect.value= today.getHours();
      minuteSelect.value= today.getMinutes();
      yearSelect.value= today.getFullYear();

      calcPhase();



    </script>





    <!-- Scripts added to the bottom to improve page loading -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>

    var moondata;
    $.getJSON('http://api.usno.navy.mil/rstt/oneday?date=1/5/2005&loc=Los Angeles, CA', function(data) {
      moondata=data;
      document.getElementById("demo").innerHTML= "The phase is " + moondata["curphase"] + "with percentage " + moondata["fracillum"];
    });
    </script>



  </body>
</html>
